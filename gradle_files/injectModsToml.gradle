def injectModsToml = { ProcessResources process ->
    def versionProperties = [
            "version": mod_version,
            "fmlVersion": forge_version.substring(0, forge_version.indexOf('.')),
            "forgeVersion": forge_version,
            "mcVersion": mc_version,
            "phosVersion": project(":Phosphophyllite").property("compatibility").toString(),
            "geckoVersion": geckolib_version
    ]

    process.inputs.properties versionProperties

    process.filesMatching("META-INF/mods.toml") {
        expand(versionProperties)
    }
}

processResources(injectModsToml)
processDatagenResources(injectModsToml)

project(":Phosphophyllite") {
    processResources {
        def phosProperties = [
                "version": project(":Phosphophyllite").property("version").toString(),
                "fmlVersion": forge_version.substring(0, forge_version.indexOf('.')),
                "forgeVersion": forge_version,
                "mcVersion": mc_version,
        ]

        inputs.properties phosProperties

        filesMatching("META-INF/mods.toml") {
            expand(phosProperties)
        }
    }
}
